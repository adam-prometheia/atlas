{% extends "layout.html" %}

{% block content %}
<div class="section-header">
    <h1>Next Actions as of {{ today.strftime("%Y-%m-%d") }}</h1>
    <span></span>
</div>

{% if interactions %}
<table>
    <thead>
        <tr>
            <th>Contact</th>
            <th>Interaction Type</th>
            <th>Summary</th>
            <th>Next Action</th>
            <th>Due Date</th>
            <th>Outcome</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for interaction in interactions %}
        <tr>
            <td><a href="/contacts/{{ interaction.contact.id }}">{{ interaction.contact.name }}</a></td>
            <td>{{ interaction.type | replace("_", " ") | title }}</td>
            <td><div class="preformatted interaction-summary">{{ interaction.summary }}</div></td>
            <td>{{ interaction.next_action or "-" }}</td>
            <td>{{ interaction.next_action_due.strftime("%Y-%m-%d") if interaction.next_action_due else "-" }}</td>
            <td>{{ interaction.outcome.replace("_", " ") | title }}</td>
            <td>
                <form method="post" action="/interactions/{{ interaction.id }}/archive-next-action" style="margin: 0;">
                    <input type="hidden" name="return_to" value="{{ request.url.path }}">
                    <button type="submit" class="button secondary">Completed</button>
                </form>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
    <p class="empty">No next actions are due today or overdue.</p>
{% endif %}
{% endblock %}
